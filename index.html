<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>4you</title>
  <style>
    body {
      margin: 0;
      font-family: "Courier New", monospace;
      background: #f0f0f0;
      color: #333;
    }
    .login, .main, .profile, .view-profile {
      display: none;
      padding: 20px;
    }
    .active { display: block; }
    
    /* Estiliza√ß√£o retro */
    .sidebar {
      width: 250px;
      background: #333;
      color: white;
      height: 100vh;
      position: fixed;
      padding: 20px;
      box-shadow: 2px 0 5px rgba(0,0,0,0.5);
    }
    .sidebar h2 {
      font-size: 2rem;
      text-align: center;
      color: #ff0;
    }
    .sidebar button {
      background: none;
      color: white;
      border: none;
      padding: 10px;
      text-align: left;
      font-size: 1.1rem;
      margin: 10px 0;
      cursor: pointer;
      width: 100%;
      transition: background-color 0.3s ease;
    }
    .sidebar button:hover {
      background-color: #444;
    }

    .content {
      margin-left: 270px;
      padding: 20px;
    }

    /* Estiliza√ß√£o dos posts */
    .post {
      background: #fff;
      border: 1px solid #ccc;
      margin-bottom: 10px;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }

    .post img {
      max-width: 100px;
      margin-top: 10px;
    }

    .textarea {
      width: 100%;
      padding: 10px;
      font-family: "Courier New", monospace;
      border: 1px solid #ccc;
      border-radius: 5px;
      background: #f9f9f9;
      margin-bottom: 10px;
      box-sizing: border-box;
    }
    
    /* Formata√ß√£o do login */
    .login input {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 5px;
      background-color: #f9f9f9;
    }

    .login button {
      background-color: #2f2f2f;
      color: white;
      border: none;
      padding: 10px 20px;
      width: 100%;
      border-radius: 5px;
      cursor: pointer;
    }
    .login button:hover {
      background-color: #444;
    }
  </style>
</head>
<body>

<!-- Tela de login -->
<div class="login active">
  <h2>FA√áA UMA CONTA PARA CONTINUAR</h2>
  <p>Assim voc√™ poder√° usar sem nenhuma preocupa√ß√£o üíØ</p>
  <input id="username" placeholder="Nome de usu√°rio" /><br/>
  <input id="password" placeholder="Senha" type="password" /><br/>
  <button onclick="register()">Entrar</button>
</div>

<!-- P√°gina principal -->
<div class="main">
  <div class="sidebar">
    <h2>4you</h2>
    <button onclick="showPage('feed')">Feed</button>
    <button onclick="showPage('profile')">Perfil</button>
    <button onclick="showPage('view-profile')">Ver Perfis</button>
  </div>

  <div class="content">
    <!-- Feed -->
    <div id="feed" class="page active">
      <h2>Postar</h2>
      <select id="topic" class="textarea">
        <option value="geral">Geral</option>
        <option value="memes">Memes</option>
        <option value="not√≠cias">Not√≠cias</option>
      </select><br/>
      <textarea id="message" class="textarea" placeholder="Escreva algo..."></textarea><br/>
      <input type="text" id="imageUrl" class="textarea" placeholder="URL da imagem (opcional)" /><br/>
      <button onclick="postMessage()">Postar</button>
      <div id="posts"></div>
    </div>

    <!-- Perfil -->
    <div id="profile" class="page">
      <h2>Editar Perfil</h2>
      <input id="profilePic" class="textarea" placeholder="URL da imagem de perfil" /><br/>
      <textarea id="bio" class="textarea" placeholder="Sua descri√ß√£o"></textarea><br/>
      <button onclick="saveProfile()">Salvar</button>
    </div>

    <!-- Ver Perfis -->
    <div id="view-profile" class="page">
      <h2>Perfis</h2>
      <div id="users"></div>
    </div>
  </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
  import { getDatabase, ref, push, onValue, set, get, child } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDg_VOK4zs9K6RVze8h_pVFr2zLEv8ZjkA",
    authDomain: "you-97263.firebaseapp.com",
    databaseURL: "https://you-97263-default-rtdb.firebaseio.com",
    projectId: "you-97263",
    storageBucket: "you-97263.appspot.com",
    messagingSenderId: "696591660594",
    appId: "1:696591660594:web:fc22fe138bd743ab9eae2b"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const usersRef = ref(db, "users/");
  const postsRef = ref(db, "posts/");

  let currentUser = null;

  function register() {
    const name = document.getElementById("username").value.trim();
    const password = document.getElementById("password").value;
    if (!name || !password) return alert("Preencha tudo");
    currentUser = name;
    set(ref(db, `users/${name}`), {
      password,
      bio: "",
      profilePic: "",
      createdAt: new Date().toISOString()
    });
    document.querySelector(".login").classList.remove("active");
    document.querySelector(".main").classList.add("active");
    loadPosts();
    loadProfiles();
  }

  function postMessage() {
    const message = document.getElementById("message").value;
    const topic = document.getElementById("topic").value;
    const image = document.getElementById("imageUrl").value;
    if (!message || !topic) return alert("Escreva algo e escolha um tema");
    push(postsRef, {
      user: currentUser,
      message,
      topic,
      image,
      time: new Date().toISOString()
    });
    document.getElementById("message").value = "";
    document.getElementById("imageUrl").value = "";
  }

  function loadPosts() {
    onValue(postsRef, snapshot => {
      const container = document.getElementById("posts");
      container.innerHTML = "";
      const data = snapshot.val();
      for (let id in data) {
        const post = data[id];
        const div = document.createElement("div");
        div.className = "post";
        div.innerHTML = `
          <b>${post.user}</b> - <i>${post.topic}</i><br/>
          ${post.message}<br/>
          ${post.image ? `<img src="${post.image}" style="max-width:100px"/>` : ""}
        `;
        container.prepend(div);
      }
    });
  }

  function saveProfile() {
    const pic = document.getElementById("profilePic").value;
    const bio = document.getElementById("bio").value;
    set(ref(db, `users/${currentUser}`), {
      password: "hidden",
      bio,
      profilePic: pic,
      createdAt: new Date().toISOString()
    });
  }

  function loadProfiles() {
    onValue(usersRef, snapshot => {
      const container = document.getElementById("users");
      container.innerHTML = "";
      const data = snapshot.val();
      for (let user in data) {
        const u = data[user];
        const div = document.createElement("div");
        div.className = "post";
        div.innerHTML = `
          <img src="${u.profilePic || ''}" style="width:50px;height:50px;border-radius:50%"/><br/>
          <b>${user}</b><br/>
          ${u.bio || ''}
        `;
        container.append(div);
      }
    });
  }

  function showPage(id) {
    document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
    document.getElementById(id).classList.add("active");
  }
</script>

</body>
  </html>
